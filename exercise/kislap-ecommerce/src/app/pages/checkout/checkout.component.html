<!-- Page Header -->
<section class="checkout-header">
  <div class="container">
    <h1 class="page-title">Checkout</h1>
    <p class="page-description">Complete your order and get your Kislap products delivered to you</p>
  </div>
</section>

<!-- Checkout Form -->
<section class="checkout">
  <div class="container">
    <form class="checkout-form" (ngSubmit)="onSubmit()">
      <div class="checkout-content">
        <!-- Order Form -->
        <div class="order-section">
          <h2 class="section-title">Order Information</h2>
          
          <!-- Personal Information -->
          <div class="form-group">
            <h3 class="form-subtitle">Personal Information</h3>
            <div class="form-row">
              <div class="form-field">
                <label for="firstName" class="form-label">First Name *</label>
                <input 
                  type="text" 
                  id="firstName" 
                  class="form-input" 
                  [(ngModel)]="orderForm.firstName" 
                  name="firstName"
                  required
                >
              </div>
              <div class="form-field">
                <label for="lastName" class="form-label">Last Name *</label>
                <input 
                  type="text" 
                  id="lastName" 
                  class="form-input" 
                  [(ngModel)]="orderForm.lastName" 
                  name="lastName"
                  required
                >
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label for="email" class="form-label">Email Address *</label>
                <input 
                  type="email" 
                  id="email" 
                  class="form-input" 
                  [(ngModel)]="orderForm.email" 
                  name="email"
                  required
                >
              </div>
              <div class="form-field">
                <label for="phone" class="form-label">Phone Number *</label>
                <input 
                  type="tel" 
                  id="phone" 
                  class="form-input" 
                  [(ngModel)]="orderForm.phone" 
                  name="phone"
                  required
                >
              </div>
            </div>
          </div>

          <!-- Shipping Address -->
          <div class="form-group">
            <h3 class="form-subtitle">Shipping Address</h3>
            <div class="form-field">
              <label for="address" class="form-label">Address *</label>
              <textarea 
                id="address" 
                class="form-textarea" 
                [(ngModel)]="orderForm.address" 
                name="address"
                rows="3"
                required
              ></textarea>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label for="city" class="form-label">City *</label>
                <input 
                  type="text" 
                  id="city" 
                  class="form-input" 
                  [(ngModel)]="orderForm.city" 
                  name="city"
                  required
                >
              </div>
              <div class="form-field">
                <label for="postalCode" class="form-label">Postal Code *</label>
                <input 
                  type="text" 
                  id="postalCode" 
                  class="form-input" 
                  [(ngModel)]="orderForm.postalCode" 
                  name="postalCode"
                  required
                >
              </div>
            </div>
          </div>

          <!-- Shipping Method -->
          <div class="form-group">
            <h3 class="form-subtitle">Shipping Method</h3>
            <div class="shipping-options">
              <div 
                *ngFor="let method of shippingMethods" 
                class="shipping-option"
                [class.selected]="selectedShipping === method.id"
                (click)="selectedShipping = method.id"
              >
                <input 
                  type="radio" 
                  [id]="method.id" 
                  [value]="method.id" 
                  [(ngModel)]="selectedShipping" 
                  name="shipping"
                  class="shipping-radio"
                >
                <label [for]="method.id" class="shipping-label">
                  <div class="shipping-info">
                    <span class="shipping-name">{{ method.name }}</span>
                    <span class="shipping-days">{{ method.days }}</span>
                  </div>
                  <span class="shipping-price">
                    {{ method.price === 0 ? 'Free' : '₱' + method.price }}
                  </span>
                </label>
              </div>
            </div>
          </div>

          <!-- Payment Method -->
          <div class="form-group">
            <h3 class="form-subtitle">Payment Method</h3>
            <div class="payment-methods">
              <div class="payment-option">
                <input 
                  type="radio" 
                  id="credit-card" 
                  value="credit-card" 
                  [(ngModel)]="orderForm.paymentMethod" 
                  name="paymentMethod"
                  class="payment-radio"
                >
                <label for="credit-card" class="payment-label">
                  <span class="payment-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="2" y="4" width="20" height="16" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                      <rect x="2" y="8" width="20" height="3" fill="currentColor"/>
                      <rect x="6" y="14" width="6" height="2" fill="currentColor"/>
                    </svg>
                  </span>
                  Credit Card
                </label>
              </div>
              <div class="payment-option">
                <input 
                  type="radio" 
                  id="gcash" 
                  value="gcash" 
                  [(ngModel)]="orderForm.paymentMethod" 
                  name="paymentMethod"
                  class="payment-radio"
                >
                <label for="gcash" class="payment-label">
                  <span class="payment-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="5" y="2" width="14" height="20" rx="2" stroke="currentColor" stroke-width="2"/>
                      <rect x="9" y="18" width="6" height="2" fill="currentColor"/>
                      <circle cx="12" cy="5" r="1" fill="currentColor"/>
                    </svg>
                  </span>
                  GCash
                </label>
              </div>
              <div class="payment-option">
                <input 
                  type="radio" 
                  id="cod" 
                  value="cod" 
                  [(ngModel)]="orderForm.paymentMethod" 
                  name="paymentMethod"
                  class="payment-radio"
                >
                <label for="cod" class="payment-label">
                  <span class="payment-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <rect x="3" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                      <circle cx="8" cy="12" r="2" fill="currentColor"/>
                      <line x1="3" y1="9" x2="21" y2="9" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </span>
                  Cash on Delivery
                </label>
              </div>
            </div>
          </div>

          <!-- Order Notes -->
          <div class="form-group">
            <h3 class="form-subtitle">Order Notes (Optional)</h3>
            <div class="form-field">
              <label for="notes" class="form-label">Special Instructions</label>
              <textarea 
                id="notes" 
                class="form-textarea" 
                [(ngModel)]="orderForm.notes" 
                name="notes"
                rows="3"
                placeholder="Any special instructions for your order..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Order Summary -->
        <div class="order-summary">
          <h2 class="summary-title">Order Summary</h2>
          
          <!-- Cart Items -->
          <div class="cart-items">
            <div class="cart-item" *ngFor="let item of cartItems">
              <div class="item-image">
                <img [src]="item.image" [alt]="item.name" class="item-img">
              </div>
              <div class="item-info">
                <h4 class="item-name">{{ item.name }}</h4>
                <div class="item-price">₱{{ item.price | number }}</div>
                <div class="item-quantity">
                  <button class="qty-btn" (click)="updateQuantity(item.id, -1)">-</button>
                  <span class="qty-value">{{ item.quantity }}</span>
                  <button class="qty-btn" (click)="updateQuantity(item.id, 1)">+</button>
                </div>
              </div>
              <div class="item-total">
                <div class="item-total-price">₱{{ (item.price * item.quantity) | number }}</div>
                <button class="remove-btn" (click)="removeItem(item.id)">Remove</button>
              </div>
            </div>
          </div>

          <!-- Order Totals -->
          <div class="order-totals">
            <div class="total-row">
              <span class="total-label">Subtotal:</span>
              <span class="total-value">₱{{ subtotal | number }}</span>
            </div>
            <div class="total-row">
              <span class="total-label">Shipping:</span>
              <span class="total-value">{{ shippingCost === 0 ? 'Free' : '₱' + shippingCost }}</span>
            </div>
            <div class="total-row">
              <span class="total-label">Tax (12% VAT):</span>
              <span class="total-value">₱{{ tax | number }}</span>
            </div>
            <div class="total-row total-final">
              <span class="total-label">Total:</span>
              <span class="total-value">₱{{ total | number }}</span>
            </div>
          </div>

          <!-- Place Order Button -->
          <button type="submit" class="btn btn-primary place-order-btn">
            Place Order - ₱{{ total | number }}
          </button>

          <!-- Security Notice -->
          <div class="security-notice">
            <div class="security-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="3" y="10" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                <path d="M7 10V7a5 5 0 0 1 10 0v3" stroke="currentColor" stroke-width="2" fill="none"/>
              </svg>
            </div>
            <p class="security-text">
              Your payment information is secure and encrypted. 
              We never store your credit card details.
            </p>
          </div>
        </div>
      </div>
    </form>
  </div>
</section>

<!-- Modal Component -->
<app-modal
  [isOpen]="showModal"
  [title]="modalTitle"
  [message]="modalMessage"
  [type]="modalType"
  (close)="closeModal()">
</app-modal>
